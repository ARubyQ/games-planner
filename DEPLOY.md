# Инструкция по развертыванию в Portainer

## Быстрое развертывание через Git Repository

### Шаг 1: Подготовка репозитория

Убедитесь, что репозиторий содержит:
- `Dockerfile`
- `docker-compose.yml`
- Все исходные файлы проекта

### Шаг 2: Развертывание в Portainer

1. Откройте Portainer
2. Перейдите в **Stacks** → **Add stack**
3. Выберите вкладку **Repository**
4. Заполните форму:
   - **Repository URL**: `https://github.com/ваш-username/ваш-repo.git`
   - **Compose path**: `docker-compose.yml` (или оставьте пустым)
   - **Stack name**: `games-planner`
   - **Build image**: Оставьте включенным (Portainer соберет образ автоматически)
5. Нажмите **Deploy the stack**

### Шаг 3: Проверка

После развертывания приложение будет доступно по адресу:
- `http://ваш-сервер:3001`

### Обновление стека

При обновлении кода в репозитории:

**Вариант 1: Через Editor (рекомендуется)**
1. В Portainer перейдите в ваш стек
2. Нажмите **Editor**
3. Нажмите **Pull and redeploy** (если доступно) или **Update the stack**
4. Portainer автоматически пересоберет образ и обновит контейнер

**Вариант 2: Принудительная пересборка**
1. В Portainer перейдите в ваш стек
2. Нажмите **Editor**
3. Убедитесь, что опция **Rebuild** или **Pull and redeploy** включена
4. Нажмите **Update the stack**

**Вариант 3: Полная пересборка (если обновления не применяются)**
1. Остановите стек
2. Удалите старый образ в разделе **Images** (опционально)
3. Запустите стек заново - образ будет собран заново без кеша

### Персистентность данных

Данные сохраняются в Docker volume `games-planner-data`. 
При пересоздании контейнера данные сохраняются.

### Изменение порта

Если нужно изменить порт, отредактируйте `docker-compose.yml`:
```yaml
ports:
  - "ВАШ_ПОРТ:3001"
```

Или используйте переменную окружения `EXTERNAL_PORT` в Portainer.

### Работа с доменом

#### Прямой доступ
- Просто укажите нужный порт в настройках стека
- Приложение будет доступно по `http://your-domain.com:3001`

#### С Nginx reverse proxy (рекомендуется для продакшена)
1. Используйте `docker-compose.proxy.yml` в Portainer
2. Настройте Nginx конфигурацию с вашим доменом
3. Настройте SSL сертификаты
4. Приложение будет доступно по `https://your-domain.com`

